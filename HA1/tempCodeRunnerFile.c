while (fread(&c, sizeof c, 1, fpipe))
    // {
    //     res[i++] = c;
    // }